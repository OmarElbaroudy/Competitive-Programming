first  : Suffix Array (http://ideone.com/PCxQxn)
second : Hashing      (http://ideone.com/0M69NC)
